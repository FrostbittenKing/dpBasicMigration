' address: 0x88c1 init: 10 name: Revrs.
00010 INIT 0:PRINT CHR$(150);:BRIGHT 1
00020 REM SCHIRM LOESCHEN
00030 TX 1,0,0:LET SL = 39
00040 REM SCHIRMBREITE
00043 DIM A(9,9), I4(8), J4(8)
00047 DIM C$(8), D$(2)
00050 STORE:CURSORY 8:CURSORX 3
00051 PRINT "SPIELSTAERKE (1 OD 2)";
00053 LINE 8,8:DISPLAY:INPUT Q$:STORE
00055 PRINT CHR$(129):RO = 24:BA = 8
00057 IF Q$<>"1" AND Q$<>"2" GOTO 1580
00059 S2 = VAL(Q$):Q$ = " "
00060 IF S2 = 2 GOTO 80
00070 LET S2 = 0
00080 B=-1:W=1:D$(B+1)="X"
00085 D$(1)=".":D$(W+1)="O"
00090 FOR K=1 TO 8
00100 READ I4(K):NEXT K
00110 DATA 0,-1,-1,-1,0,1,1,1
00120 FOR K=1 TO 8
00130 READ J4(K):NEXT K
00140 DATA 1,1,0,-1,-1,-1,0,1
00150 FOR K=1 TO 8
00160 READ C$(K):NEXT K
00170 DATA A,B,C,D,E,F,G,H
00180 FOR I=0 TO 9
00190 FOR J=0 TO 9
00200 A(I,J)=0:NEXT J:NEXT I
00210 A(4,4)=W:A(5,5)=W
00215 A(4,5)=B:A(5,4)=B
00220 C1=2:H1=2:N1=4:Z=0
00230 TX 5,0,0:CURSORY 10:CURSORX 3
00233 PRINT "MOECHTEST DU X ODER ";
00237 PRINT "O HABEN";:LINE 10,10
00240 DISPLAY:C = W:H = B
00250 INPUT X$:STORE:RO = 30:BA = 10
00260 IF X$="X" GOTO 290
00270 IF X$<>"O" GOTO 1580
00280 LET C = B:LET H = W
00290 TX 2,0,0:CURSORY 12:CURSORX 3
00291 PRINT "MOECHTEST DU ";:X$ = " "
00293 PRINT "DEN ERSTEN ZUG (J/N)";
00295 PRINT CHR$(146);:DISPLAY:INPUT X$
00296 STORE:RO = 36:BA = 12
00297 IF X$<>"J" AND X$<>"N" GOTO 1580
00299 PRINT CHR$(143):FOR NG=1 TO 600
00300 NEXT NG:SOUND 5:SOUND 4
00303 INIT 0:PRINT CHR$(150);:BRIGHT 1
00307 REM SCHIRM LOESCHEN
00310 IF X$<>"J" GOTO 340
00320 GOSUB 1430:GOTO 680
00330 PRINT CHR$(138);
00340 GOSUB 1430
00345 B1=-1:I3=0:J3=0:T1=C:T2=H
00350 LET I = 0
00355 I=I+1:IF I>8 GOTO 530
00360 LET J = 1
00370 IF A(I,J)<>0 GOTO 510
00380 GOSUB 1200
00390 IF F1=0 GOTO 510
00400 LET U = -1
00410 GOSUB 1260
00420 IF S1=0 GOTO 510
00430 IF (I-1)*(I-8)<>0 GOTO 450
00440 S1 = S1 + S2
00450 IF (J-1)*(J-8)<>0 GOTO 470
00460 S1 = S1 + S2
00470 IF S1<B1 GOTO 510
00480 IF S1>B1 GOTO 500
00490 IF RND(1)>0.5 GOTO 510
00500 B1=S1:I3=I:J3=J
00510 J = J + 1:IF J = 9 GOTO 520
00515 GOTO 370
00520 GOTO 355
00530 IF B1>0 GOTO 570
00540 TX 5,0,0:Y=14:GOSUB 1510:Y=11
00543 GOSUB 1510:PRINT:PRINT TAB(9);
00545 PRINT "ICH KANN NICHT";
00547 PRINT " ZIEHEN!";CHR$(145)
00550 IF Z=1 GOTO 1970
00560 LET Z = 1:GOTO 680
00570 LET Z = 0
00580 TX 3,0,0:Y=15:GOSUB 1510
00581 Y=11:GOSUB 1510:PRINT TAB(12);
00583 PRINT "ICH ZIEHE AUF";
00587 PRINT I3;"-";C$(J3);CHR$(146)
00590 I=I3:J=J3:U=1
00600 GOSUB 1260
00610 C1=C1+S1+1:H1=H1-S1:N1=N1+1
00620 Y=13:GOSUB 1510:TX 1,0,0
00623 PRINT SPC(4);
00625 IF S1 > 9 THEN PRINT CHR$(137);
00627 PRINT "DA BEKOMME ICH";S1;
00630 IF S1>1 THEN PRINT " STEINE VON";
00635 IF S1>1 THEN PRINT " DIR":SCREEN
00640 IF S1=1 THEN PRINT " STEIN VON ";
00645 IF S1=1 THEN PRINT "DIR":SCREEN
00650 GOSUB 1430
00660 IF H1=0 GOTO 1080
00670 IF N1=64 GOTO 1080
00680 LET T1 = H:LET T2 = C
00690 TX 6,0,0:Y=16:GOSUB 1510
00693 PRINT SPC(12);"WOHIN SETZT DU?"
00695 PRINT SPC(11);"(0, O = VERZICHT)"
00697 PRINT TAB(12);"?";:LINE 17,19
00699 GOSUB 1680:I = VAL(P$)
00700 PRINT I;SPC(9);"? ";:LINE 19,19
00705 GOSUB 1730:PRINT X$;CHR$(146)
00710 Y=12:GOSUB 1510:Y=11:GOSUB 1510
00720 Y=13:GOSUB 1510:CURSORY 17
00730 PRINT CHR$(158);:SCREEN
00740 IF I<>0 GOTO 810
00750 TX 2,0,0:Y=15:GOSUB 1510
00760 PRINT "  VERZICHTEST DU AUF EIN";
00763 PRINT "EN ZUG (J/N)? ";CHR$(146);
00767 GOSUB 1790:Y=15:GOSUB 1510
00770 IF X$<>"J" GOTO 690
00780 IF Z=1 GOTO 1080
00790 LET Z = 1
00800 GOTO 330
00810 LET J = 1
00820 IF C$(J)=X$ GOTO 850
00830 J = J + 1:IF J > 8 GOTO 840
00835 GOTO 820
00840 GOTO 690
00850 IF A(I,J)=0 GOTO 890
00860 Y=13:GOSUB 1510:TX 3,0,0
00870 PRINT " TUT MIR LEID, DI";
00873 PRINT "ESES FELD IST ";
00877 PRINT "BESETZT!":LINE 14,14
00880 GOTO 690
00890 GOSUB 1200
00900 IF F1=1 GOTO 940
00910 Y=13:GOSUB 1510:TX 7,0,0
00920 PRINT SPC(12);"NICHT ERLAUBT!"
00923 CURSORX 7:PRINT "(NICHT NEBEN ";
00927 PRINT "STEIN VON MIR)":LINE 14,15
00930 FOR TC=1 TO 400:NEXT TC:Y=14
00935 GOSUB 1510:GOTO 690
00940 LET U = -1:GOSUB 1260
00950 IF S1>0 GOTO 990
00960 Y=13:GOSUB 1510:TX 7,0,0
00970 PRINT " DAMIT BEKOMMST DU KEINE";
00975 PRINT "N STEIN VON MIR";CHR$(146)
00980 GOTO 690
00990 LET Z = 0:Y=15:GOSUB 1510
00993 CURSORX 5:TX 2,0,0
00995 IF S1<>1 THEN CURSORX 4
00997 PRINT "DA BEKOMMST DU";S1;
01000 IF S1=1 THEN PRINT " STEIN VON ";
01005 IF S1=1 THEN PRINT "MIR!":SCREEN
01010 IF S1>1 THEN PRINT " STEINE VON";
01015 IF S1>1 THEN PRINT " MIR!":SCREEN
01020 LET U = 1:GOSUB 1260
01030 H1=H1+S1+1:C1=C1-S1:N1=N1+1
01040 GOSUB 1430
01050 IF C1=0 GOTO 1080
01060 IF N1=64 GOTO 1080
01070 GOTO 330
01080 X$ = " ":TX 6,0,0:CURSORY 11
01081 PRINT CHR$(158);CHR$(145)
01083 GOSUB 1920:PRINT "DU HAST";H1;
01085 PRINT " STEINE, ICH HABE";C1;
01087 PRINT " STEINE.";CHR$(146)
01090 IF H1=C1 GOTO 1130
01100 IF H1>C1 GOTO 1140
01110 PRINT CHR$(138);:PRINT:TX 7,5,0
01120 PRINT TAB(9);"ICH HABE GEWONNE";
01121 PRINT "N!!!";CHR$(132)
01123 PRINT SPC(9);"ICH HABE GEWONNEN";
01125 PRINT "!!!";CHR$(132);:LINE 15,16
01127 GOTO 1150
01130 TX 3,3,1:CURSORY 16:PRINT "    ";
01131 PRINT "U N E N T S C H I E D E ";
01133 PRINT "N ! ! ":PRINT "    U N ";
01135 PRINT "E N T S C H I E D E N ! ";
01136 PRINT "! ";CHR$(145);
01137 FOR SK=1 TO 3800:NEXT SK:RESTORE
01138 INIT 0:PRINT CHR$(150);
01139 BRIGHT 1:TX 1,0,0:GOTO 50
01140 TX 2,7,0:CURSORY 15:PRINT "D U ";
01141 PRINT "  H A S T   G E W O N N ";
01143 PRINT "E N ! ! ! ":PRINT "D U  ";
01145 PRINT " H A S T   G E W O N N ";
01147 PRINT "E N ! ! ! ";:LINE 15,16
01150 PRINT CHR$(138);:PRINT:PRINT
01153 TX 1,1,0:PRINT SPC(13);"NOCH ";
01157 PRINT "EINMAL?":PRINT TAB(13);
01160 PRINT "NOCH EINMAL?";:SCREEN
01163 IF KEY(0) = 110 GOTO 1180
01167 IF KEY(0) = 106 GOTO 1840
01170 GOTO 1163
01180 PAGE:CURSORX 1:CURSORY 19
01183 PRINT CHR$(158);:PRINT:CURSORX 12
01185 TX 5,6,1:PRINT "G O O D   ";
01187 PRINT "B Y E ";CHR$(146):PRINT
01189 FOR AC=1 TO 2200:NEXT AC:SCROLL
01190 PRINT CHR$(159);:END
01200 LET F1 = 0:FOR I1=-1 TO 1
01210 FOR J1=-1 TO 1
01220 IF A(I1+I,J1+J)=T2 THEN F1=1
01230 NEXT J1:NEXT I1
01240 RETURN
01250 PRINT CHR$(138);
01260 LET S1 = 0:FOR K=1 TO 8
01270 I5=I4(K):J5=J4(K)
01280 I6=I+I5:J6=J+J5
01290 S3 = 0:IF A(I6,J6)<>T2 GOTO 1410
01300 LET S3 = S3 + 1:I6=I6+I5:J6=J6+J5
01310 IF A(I6,J6)=T1 GOTO 1340
01320 IF A(I6,J6)=0 GOTO 1410
01330 GOTO 1300
01340 LET S1 = S1 + S3
01350 IF U<>1 GOTO 1410
01360 LET I6 = I:LET J6 = J
01370 FOR K1=0 TO S3
01380 A(I6,J6) = T1
01390 I6=I6+I5:J6=J6+J5
01400 NEXT K1
01410 NEXT K
01420 RETURN
01430 TX 7,0,0:STORE:PRINT CHR$(140);
01435 CURSORX 11:PRINT "   A ";
01440 PRINT "B C D E F G H"
01450 FOR I=1 TO 8:CURSORX 11
01460 PRINT I;
01470 FOR J=1 TO 8
01480 PRINT " ";D$(A(I,J)+1);:NEXT J
01490 PRINT:NEXT I:LINE 2,10
01500 RETURN
01510 REM *****************************
01513 REM * POSITIONIEREN DES CURSORS *
01517 REM ******** IN ZEILE Y *********
01520 CURSORY Y:PRINT CHR$(140);
01530 FOR HI=1 TO Y-1:PRINT:NEXT HI
01540 FOR HI=1 TO SL:PRINT " ";:NEXT HI
01550 PRINT CHR$(140);:FOR HI=1 TO Y-1
01560 PRINT:NEXT HI
01570 PRINT CHR$(145);:RETURN
01580 REM ### LOESCHEN DER FALSCHEN ###
01590 REM ## EINGABEN VOM BILDSCHIRM ##
01600 CURSORY BA:CURSORX RO
01610 PRINT CHR$(132);:LINE BA,BA
01620 DISPLAY:IF BA = 8 THEN INPUT Q$
01630 IF BA = 8 THEN STORE:GOTO 57
01640 IF BA = 10 THEN INPUT X$:STORE
01650 IF BA = 10 GOTO 260
01660 IF BA = 12 THEN INPUT X$:STORE
01670 IF BA = 12 GOTO 297
01680 REM | EINGABE DER VARIABLE "I" |
01690 FOR GF=48 TO 56
01700 IF KEY(0) = GF THEN P$ = CHR$(GF)
01710 IF KEY(0) = GF THEN RETURN
01720 NEXT GF:GOTO 1690
01730 REM / EINGABE DER VARIABLE "X$" /
01740 IF KEY(0)=111 THEN X$="O":RETURN
01750 FOR OA=97 TO 104
01760 IF KEY(0)=OA THEN X$=CHR$(OA-32)
01770 IF KEY(0)=OA THEN RETURN
01780 NEXT OA:GOTO 1740
01790 REM ENTSCHEIDUNG FUER ODER GEGEN
01800 REM @ DEN VERZICHT EINES ZUGES @
01810 IF KEY(0)=106 THEN X$="J":RETURN
01820 IF KEY(0)=110 THEN X$="N":RETURN
01830 GOTO 1810
01840 REM >>>>>>>> BILDSCHIRM <<<<<<<<
01850 REM >> AUF ANFANGSWERT SETZEN <<
01860 INIT 0:PRINT CHR$(150);:BRIGHT 1
01870 TX 1,0,0:STORE:CURSORY 8
01880 CURSORX 3:PRINT "SPIELSTAERKE ";
01890 PRINT "(1 OD 2)?";
01895 IF S2=0 THEN PRINT " 1";CHR$(146)
01900 IF S2=0 GOTO 180
01905 PRINT S2;CHR$(146)
01910 GOTO 180
01920 REM BESTIMMUNG DER DRUCKPOSITION
01930 CU$ = STR$(H1)
